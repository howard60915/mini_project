<h1><span style="font-size: 50px"><%= @topic.title%></span></h1>
<%= @topic.status %>
<div id="like-number">
	<%= @topic.like_users.count %>  likes
</div>
<div id="like">
	<%= (render :partial => 'like')   %>	
</div>

<div id="subscribe">
	<%= (render :partial => 'subscribe')   %>
</div>

<div><%= image_tag @topic.logo.url(:medium) %></div>
<span style="font-size: 35px">content</span>

<br \>
<table class="table table-striped table-hover">
	<thead><span style="font-size: 20px"><%= @topic.content %></span></thead>
		<tr>
			<td><span style="font-size: 20px">Comment :</span></td>
			<td></td>
			<td ><span style="text-align: left">Poster</span></td>
			<td></td>
			<td></td>
			
		</tr>
		<% @topic.comments.each do |c| %>
			<% if c.status == 'published' %>
				<tr>
					<td><%= c.content %></td>
					<td><%= image_tag c.avatar.url(:thumb)%></td>
					<td><%= c.user.short_name %></td>
					<td><%= link_to "Edit" , topic_path(:id => @topic.id , :comment_id => c.id), :class => "btn btn-primary" %></td>
					<td><%= link_to "Delete" , topic_comment_path(@topic,c.id), :method => "delete", :class => "btn btn-danger" %></td>
					<td><%= c.user.short_name %></td>
				</tr>
			<% elsif c.status == 'draft' && current_user == c.user %>
				<tr>
					<td><p style="color: #f0f"><%= c.content %></p></td>
					<td><%= link_to "Edit" , topic_path(:id => @topic.id , :comment_id => c.id), :class => "btn btn-primary" %></td>
					<td><%= link_to "Delete" , topic_comment_path(@topic,c.id), :method => "delete", :class => "btn btn-danger" %></td>
					<td><%= c.user.short_name %></td>
				</tr>
			<% end %>
		<% end %>
		
</table>
<%#if @topic.comments.errors.any?%>
	<%# @topic.comments.errors.full_messages.each do |msg|%>
	<%#= msg%>
	<%# end %>
<%# end %>



<%= form_for [@topic, @comment], html: { multipart: true } do |f|%> <!-- rails 會自動幫我們判別是經由create還是update -->
	<%= f.label :content ,"Comment"%>
	<%= f.text_area :content ,:class => "form-control"%>
	<div class="form-group">
		<%= f.label :avatar , "上傳圖片" %>
		<%= f.file_field :avatar %>
		<% if @comment.avatar.exists?%>	
			<%= check_box_tag "remove_comment_file", "1" %>移除上傳檔案
		<% end %>	
	</div>
	<div class="form-group">
	<%= f.label :status, "Status" %>
    <%= f.radio_button :status, "published"%>Published
    <%= f.radio_button :status, "draft"%>Draft
	</div>	

	<%= f.submit "confirm" , :class => "btn btn-success"%>
<% end %>


<br \>
<%= link_to "Back to Index" , topics_path , :class => "btn btn-primary"%>



